/*! power by xiu front end team  build by grunt   */
function clearLoginName(a,b){"手机号/邮箱/用户名"==a.value&&(a.value=""),a.className="input",a.nextSibling.title?a.nextSibling.innerHTML=a.nextSibling.title:a.nextSibling.nextSibling.nextSibling.innerHTML=a.nextSibling.nextSibling.nextSibling.title,a.nextSibling.className&&(a.nextSibling.className="tips"),a.nextSibling.nextSibling.nextSibling.className&&"password"!=a.nextSibling.nextSibling.nextSibling.type&&(a.nextSibling.nextSibling.nextSibling.className="tips"),a.onblur=function(){a.value.length<1&&(a.value=b,a.className="input tip")}}function valIsEmpty(a){return a=a.replace(/(^\s*)|(\s*$)/g,""),a.length}function showLoginName(){var a=$.cookie("xiu.login.loginName");null!=a&&""!=a&&$("#J_mobile").attr("value",a)}function getDisplayContent(a,b,c){var d=encodeURIComponent(location.href),e='<div class="content LoginPanels" id="xiuPopContent"><div id="J_login_panel" class="login-panel-pop">';return 1==c?(e+='<ul class="login-tab"><li><a href="javascript:void(0);" id="displayLogin1" class="active">短信登录</a></li><li><a href="javascript:void(0);" id="displayLogin2">密码登录</a></li></ul><div class="login-form clfix"><ul><li id="J_errorMsgBox" class="err-msg"><label class="login-err-msg"><b></b><span id="J_errorMsgTxt"></span></label></li><li class="username"><input id="J_mobile" class="ltext shadow-input" type="text" name="userName" value=""><input id="statecode" name="statecode" type="hidden"/><label id="J_mobile_wel" for="J_mobile" class="input-tip">手机号码</label><label id="J_moblie_tip" style="display:none;"><p>新手机号将认为接受<a href="http://www.xiu.com/help/xieyi.shtml" target="_blank">《走秀网用户协议》</a>并自动注册账号</p></label></li><li id="authCode_errorMsgBox" class="err-msg"><label class="login-err-msg"><b></b><span id="authCode_errorMsgTxt"></span></label></li><li class="authcode" id="authcode_li" style="display:none;"><input id="J_auth_code" class="ltext shadow-input" type="text" name="checkCode"><label id="J_authcode_wel" for="J_auth_code" class="input-tip" title="请填入验证码答案">验证码</label><span id="authCodeMsg"></span><a href="javascript:void(0);" class="code-img"><img src="" id="authCodeImg" title="请填入验证码"></a><a href="javascript:void(0);" class="change-code">换一换</a><span class="clfix"></span></li><li id="msgCode_errorMsgBox" class="err-msg"><label class="login-err-msg"><b></b><span id="msgCode_errorMsgTxt"></span></label></li><li class="msgcode" id="msgcode_li"><input id="J_msgcode" class="ltext shadow-input" type="text" name="msgcode"><label id="J_msgcode_wel" for="J_msgcode" class="input-tip">短信验证码</label><a id="J_msg_code_btn" href="javascript:void(0);" class="phone_login_btn" onclick="sendAuthCodeClick();">获取验证码</a><a id="J_auth_code_wait" href="javascript:void(0);" class="phone_login_btn2" onClick="sendAuthCodeClick();"><em class="time">30s</em></a><span class="clfix"></span><label id="J_voice_btn" style="display:none;"><p>收不到验证码？<a href="javascript:void(0);" onClick="sendVoiceCodeClick(this);">获取语音验证码</a></p></label></li><li class="check-opt autologin"><label id="J_autologin_lab" for="J_autologin" class="autologinb checked"><span></span><input id="J_autologin" type="checkbox" checked="true" class="lcheck" name="autoLogin">两周内自动登录</label><div id="J_autologin_tip" class="alert-tip hide" style="display: none;"><i></i><b></b>为了账户安全，请勿在公共电脑上勾选此项。</div><div class="getpassreg"><a href="http://login.xiu.com/retrivepwd" class="getpass" target="_blank">找回密码</a></div></li><li class="clfix"><button class="login-btn" id="login_Btn" type="submit">登&nbsp;&nbsp;&nbsp;&nbsp;录</button></li></ul></div>',e+='<script type="text/javascript" src="http://www.xiustatic.com/static/js/xiu/user_box_login.min.js"></script>'):2==c?(e+='<ul class="login-tab"><li><a href="javascript:void(0);" id="displayLogin1">短信登录</a></li><li><a href="javascript:void(0);" id="displayLogin2" class="active">密码登录</a></li></ul><div class="login-form clfix"><ul><li id="J_errorMsgBox" class="err-msg"><label class="login-err-msg"><b></b><span id="J_errorMsgTxt"></span></label></li><li class="username"><input id="J_mobile" class="ltext shadow-input" type="text" name="userName" maxlength="50" value=""><label id="J_mobile_wel" for="J_mobile" class="input-tip">手机号/邮箱/用户名</label></li><li id="J_errorMsgBox" class="err-msg"><label class="login-err-msg"><b></b><span id="passWord_errorMsgTxt"></span></label></li><li class="password"><input id="J_password" class="ltext shadow-input" type="password" name="passWord" maxlength="16"><label id="J_password_wel" for="J_password" class="input-tip">密码</label></li><li id="J_errorMsgBox" class="err-msg"><label class="login-err-msg"><b></b><span id="checkCode_errorMsgTxt"></span></label></li><li class="authcode" id="authcode_li" style="display:none;"><input id="J_auth_code" class="ltext shadow-input" type="text" name="checkCode" maxlength="4"><label id="J_authcode_wel" for="J_auth_code" class="input-tip" title="请填入验证码答案">验证码</label><span id="authCodeMsg"></span><a href="javascript:void(0);" class="code-img"><img src="" id="authCodeImg" title="请填入验证码"></a><a href="javascript:void(0);" class="change-code" id="changeChkCd">换一换</a><span class="clfix"></span></li><li class="check-opt autologin"><label id="J_autologin_lab" for="J_autologin" class="autologinb checked"><span></span><input id="J_autologin" type="checkbox" class="lcheck" name="autoLogin" checked="true">两周内自动登录</label><div id="J_autologin_tip" class="alert-tip hide"><i></i><b></b>为了账户安全，请勿在公共电脑上勾选此项。</div><div class="getpassreg"><a href="http://login.xiu.com/retrivepwd" class="getpass">找回密码</a> | <a href="javascript:void(0);" id="regDisplayPage" class="getpass">注册账号</a></div></li><li class="clfix"><button class="login-btn" id="login_Btn" type="submit">登&nbsp;&nbsp;&nbsp;&nbsp;录</button></li></ul></div>',e+='<script type="text/javascript">var $loginTip = "登录中....";</script>'):e+='<h3 class="login_code_t">手机扫码登录</h3><div class="login_code"><p class="login-err-msg"></p><div id="login_code_show"><div class="login_code_img" id="login_code_img"><img src="" id="loginqrcode"><div class="login_code_lose" id="login_code_refresh" style="display:none"><div class="login_code_losebg"></div><div class="login_code_losebc"><h3>二维码已失效</h3><a href="javascript:;" onclick="getLoginCode();">请点击刷新</a></div></div></div> <p>打开<a href="http://app.xiu.com" target="_blank"><span>走秀APP</span></a>，扫一扫登录</p></div><div id="login_code_check" style="display: none;"><p class="login_code_ok"></p><h3 class="login_code_okt">扫描成功！</h3><p>请在手机上确认登录</p></div></div><a href="javascript:void(0);" class="login_normal_turn login_pcgo"></a><a href="javascript:void(0);" class="login_normal_turn login_ewmb"></a>',3!=c&&(e+='<div class="login-extinfo"><dt id="J_api_login_opt" class="optbar"><span class="tit">合作网站账号登录</span></dt><dd id="J_api_login_box"><ul class="api-login clfix"><li><a href="'+url.union+"tencent/redirectNew.action?url="+d+'" class="api-qq" target="_blank" title="QQ账号"></a></li><li><a href="'+url.union+"wechat/redirectNew.action?url="+d+'" class="api-wechat" target="_blank" title="微信账号"></a></li><li><a href="'+url.union+"sina/redirectNew.action?url="+d+'" class="api-sina" target="_blank" title="新浪微博"></a></li><li><a href="'+url.union+"alipay/redirectNew.action?type=login&url="+d+'" class="api-alipay" target="_blank" title="支付宝账号"></a></li><li class="last"><a href="'+url.union+"pingAn/redirectNew.action?url="+d+'" class="api-pingan" target="_blank" title="平安万里通"></a></li></ul></dd></div><a href="javascript:void(0);" class="login_code_turn login_codego"></a><a href="javascript:void(0);" class="login_code_turn login_ewmg"></a>'),e+='</div></div><input type="hidden" name="loginDisplayType" id="loginDisplayType" value="'+c+'"/><input type="hidden" name="showCheckCode" id="showCheckCode"/><input type="hidden" name="xiuLoginName" id="xiuLoginName" value=""/><input type="hidden" name="forwordURL" id="forwordURL" value=""/><input type="hidden" name="rd" id="rd" value=""/><input type="hidden" id="loginBox" value="loginBox"/><input type="hidden" id="parentPage" value="${param.parentPage}"/><input type="hidden" id="authCode" name="authoCode"/><input type="hidden" id="imgCode" name="imgCode"/> <input type="hidden" id="xiuIndex" value="http://www.xiu.com"/>'}function loginPop(a,b,c){if(!c){var d=$.cookie("xiu.login.loginType");c=null!=d&&""!=d?d:1}a&&$(a).blur();var e=getDisplayContent(a,b,c);$.xiupop({title:'您尚未登录 <span class="aparentNodeSpan"> </span>',content:e,contentCss:"LoginPanels",hasBg:!0,center:!0,width:"500px",skin:"white",callback:function(){3!=c?(showLoginName(),bindElement(),$("#login_Btn").click(function(){var c=$("#login_Btn").text();return"登录中...."!=c&&"注册中...."!=c&&(requestLoginPOP(a,b),!1)}),checkQrCodeStop()):(getLoginCode(),_e=a,_callback=b),$("#displayLogin1,#regDisplayPage").click(function(){loginPop(a,b,1)}),$("#displayLogin2").click(function(){loginPop(a,b,2)}),$(".login_normal_turn").click(function(){var d=$.cookie("xiu.login.loginType");c=null!=d&&""!=d&&3!=d?d:2,loginPop(a,b,c)}),$(".login_code_turn").click(function(){loginPop(a,b,3)})}})}function getLoginCode(){checkQrCodeStop(),$("#loginqrcode").removeAttr("style"),$("#login_code_refresh").hide(),$.ajax({type:"GET",async:!0,timeout:1e4,url:"http://portal.xiu.com/business/loginqrcodeinfo?format=jsonp&timeStamp="+(new Date).getTime(),dataType:"jsonp",jsonp:"jsoncallback",success:function(a){if(a&&a.result&&"success"==a.result){qriduuid="/"+a.qrcodeid+"/"+a.codeid;var b="http://portal.xiu.com/business/loginqrcode"+qriduuid;return $("#loginqrcode").attr("src",b),intCheckQRCode=window.setInterval(checkQRCode,1500),!1}$(".login-err-msg").text("获取二维码错误！")},error:function(){$(".login-err-msg").text("获取二维码错误！")}})}function isQRTimeOut(){$("#loginqrcode").css({opacity:"0.2",filter:"alpha(opacity=20)"}),$("#login_code_show").show(),$("#login_code_check").hide(),$("#login_code_refresh").show(),checkQrCodeStop()}function checkQrCodeStop(){window.clearInterval(intCheckQRCode)}function checkQRCode(){$.ajax({type:"POST",async:!1,timeout:3e4,url:"http://portal.xiu.com/business/loginqrcodecheck"+qriduuid+"?format=jsonp&timeStamp="+(new Date).getTime(),dataType:"jsonp",jsonp:"jsoncallback",success:function(a){a&&a.result&&("undefined"==typeof a.result?(checkQrCodeStop(),$(".login-err-msg").text("系统繁忙，请稍后再试")):"success"==a.result?(checkQrCodeStop(),$(".login_code_okt").text("登录中..."),$._xiu_login.loginCMS(),$.closepop(),$.cookie("toUrl",null,{expires:-1,path:"/",domain:".xiu.com",secure:!1}),_callback(_e)):"wait"==a.result?($("#login_code_show").hide(),$("#login_code_check").show()):"invalid"==a.result?isQRTimeOut():"faild"==a.result?(checkQrCodeStop(),$(".login-err-msg").text("登录失败，请稍后再试或联系管理员。errorCode："+a.errorCode)):(checkQrCodeStop(),$(".login-err-msg").text("系统繁忙，请稍后再试")))},error:function(){window.clearInterval(intCheckQRCode)}})}function bindElement(){$("#J_api_login_opt").click(function(){var a=$("#J_api_login_opt").find("b");if(a.toggleClass("up"),!$.browser.msie||"6.0"!=$.browser.version&&"7.0"!=$.browser.version&&"8.0"!=$.browser.version)$("#J_api_login_box").slideToggle(300,function(){"undefined"!=typeof LoginBgShadow&&LoginBgShadow()});else if($("#J_api_login_box").toggleClass("hide"),"undefined"!=typeof LoginBgShadow)try{LoginBgShadow()}catch(b){}}),$("#J_autologin_lab").hover(function(){$("#J_autologin_tip").show()},function(){$("#J_autologin_tip").hide()}),$(".code-img, .change-code").bind("click",function(){return $("#authCodeImg").attr("src",url.portal+"kaptcha.jpg?_="+Math.random()),!1}),$("#J_autologin").click(function(){$(this).parent().toggleClass("checked")});var a=$("#J_mobile"),b=$("#J_auth_code"),c=$("#J_password"),d=$("#J_msgcode");a.data("welcome",$("#J_mobile_wel")),b.data("welcome",$("#J_authcode_wel")),d.data("welcome",$("#J_msgcode_wel")),c.data("welcome",$("#J_password_wel"));var e=a.val();e.length>0&&a.data("welcome").addClass("focus_tip").show();var f=c.val();f&&f.length>0&&c.data("welcome").hide(),$("#J_mobile,#J_auth_code,#J_msgcode,#J_password").focus(function(){var a=$(this);a.val();a.addClass("focus"),a.removeClass("error"),a.data("welcome").removeClass("error_tip"),a.data("welcome").addClass("focus_tip").show()}).blur(function(){var a=$(this),b=a.val();a.removeClass("focus"),0==b.length&&a.data("welcome").removeClass("focus_tip").show()}).keyup(function(){var a=$(this);a.val()})}function requestLoginPOP(a,b){if(validateForm()){var c=createQueryString();b=b||function(){},deleteWCSInvalidCookie();var d=$("#login_Btn");d.css("cursor","default"),d.text($loginTip),d.addClass("login_disable"),d.attr("disabled","true"),this.disableAjax=!1,this.disableAjax||$.ajax({type:"post",url:url.loginfloaturl,data:c,dataType:"JSON",success:function(c){if(c&&c.length>0){var d=c[0];"login.success"==d.loginResult?($._xiu_login.loginCMS(),$.closepop(),$.cookie("toUrl",null,{expires:-1,path:"/",domain:".xiu.com",secure:!1}),"true"==d.bindMobile?window.location.href="https://login.xiu.com/bindcellphone/normal?returnUrl="+encodeURIComponent(d.redirectUrl):b(a)):loginCallBack(c)}},error:function(){alert("登录失败")},complete:function(){setLoginBtnStyle(),this.disableAjax=!0}})}}function checkLogin(a,b){$.ajax({type:"POST",url:url.checkloginurl,data:{isTest:"1"},dataType:"JSON",async:!1,cache:!1,success:function(c){c=jsonData(c),c.isAlreadyLogin?b(a):loginPop(a,b)},error:function(){alert("登录失败!")}})}function findWCSInvalidCookie(a){var b=[],c=0;if(document.cookie&&""!=document.cookie)for(var d=document.cookie.split(";"),e=0;e<d.length;e++){var f=$.trim(d[e]);if(f.indexOf(a)!=-1){var g=f.indexOf("=");b[c++]=$.trim(f.substring(0,g))}}return b}function deleteWCSInvalidCookie(){try{var a=$.trim($.cookie("WC_USERACTIVITY_-1002"));if(null!=a&&""!=a)for(var b=findWCSInvalidCookie("WC_"),c=0;c<b.length;c++)$.cookie(b[c],null,{expires:-1,path:"/",domain:".xiu.com",secure:!1})}catch(d){}}function xiuRegPop_cms(a,b){var c=encodeURIComponent(location.href),d='<iframe id="loginFrame" src="http://portal.xiu.com/business/userRegPopBox?parentPage='+c+'" frameborder="0" scrolling="no" width="100%" height="400px" name="loginFrame"></iframe>',e=a;$.xiupop({title:'请注册 <span class="aparentNodeSpan">已有走秀帐号？请 <a href="#" id="userReg" class="loginTag">登录</a></span>',content:d,contentCss:"LoginPanels",hasBg:!0,center:!0,width:"520px",skin:"white",callback:function(){$(".loginTag").click(function(){return loginPop(e,b),!1})}})}function setLoginBtnStyle(){setTimeout(function(){var a=$("#login_Btn");a.removeClass("login_disable"),a.removeAttr("disabled"),a.html("登&nbsp;&nbsp;&nbsp;&nbsp;录"),a.css("cursor","pointer")},500)}function xiuTips(a,b,c,d){return showTipDiv(a,b,c,d)}function hideTipDiv(){$("#xiuTipBox").data("remove")&&clearTimeout($("#xiuTipBox").data("remove")),$("body").data("showTip")&&clearTimeout($("body").data("showTip")),document.getElementById("xiuTipBox")&&$("#xiuTipBox").remove()}function showTipDiv(a,b,c,d){hideTipDiv(),a=a?a:"",b=b?parseInt(b):0,c=c?parseInt(c):0,d=d?1e3*d:3e3;var e="";e+='<div class="popupDiv" id="xiuTipBox" style="position:absolute; display:none; left:'+b+"px; top:"+c+'px"><div class="M_infoTop"></div><div class="M_infocontents">',e+=a,e+="</div></div>",$("body").append(e);var f=$("#xiuTipBox");f.hover(function(){$(this).data("remove")&&clearTimeout($(this).data("remove"))},function(){$(this).data("remove",setTimeout(function(){hideTipDiv()},d))}),$("body").data("showTip",setTimeout(function(){f.show().data("remove",setTimeout(function(){hideTipDiv()},d))},100))}function getAbsoluteLeft(a){for(o=a,oLeft=o.offsetLeft;null!=o.offsetParent;)oParent=o.offsetParent,oLeft+=oParent.offsetLeft,o=oParent;return oLeft}function getAbsoluteTop(a){for(o=a,oTop=o.offsetTop;null!=o.offsetParent;)oParent=o.offsetParent,oTop+=oParent.offsetTop,o=oParent;return oTop}document.domain="xiu.com",document.onkeyup=function(a){var b=document.all?window.event:a;try{13==b.keyCode&&($("#displayLogin1").hasClass("active")||$("#displayLogin2").hasClass("active"))&&$("#login_Btn").click()}catch(b){}};var qriduuid,intCheckQRCode,_e,_callback,disableAjax;!function(a){a.closepop=function(){a("#xiuPopBox").data("remove")&&clearTimeout(a("#xiuPopBox").data("remove")),a("body").data("showXiuPop")&&clearTimeout(a("body").data("showXiuPop")),document.getElementById("xiuPopCopy")&&a("#xiuPopBox").data("xiuPopCon").replaceAll("#xiuPopCopy"),document.getElementById("xiuPopBoxBG")&&a("#xiuPopBoxBG").remove(),document.getElementById("xiuPopBox")&&a("#xiuPopBox").remove(),a(window).unbind("scroll.popBox")},a.xiupop=function(b){function c(){var b=a(h).width(),c=a(h).height(),d=j?0:a(h).scrollTop();o.css({top:c/2-q/2+d,left:b/2-p/2}),a("body").data("sTop",d),"absolute"==m&&a(h).unbind("scroll.popBox").bind("scroll.popBox",function(){if(o[0].style.top=i.documentElement.scrollTop+c/2-q/2,e.hasBg){var a=i.documentElement.scrollHeight,b=i.getElementById("xiuPopBoxBG").style.height;parseInt(b,10)!=a&&(i.getElementById("xiuPopBoxBG").style.height=a+"px")}})}var d=this;d.close=function(){a.closepop()};var e=a.extend({time:0,pageX:0,pageY:0,title:!1,skin:"",hasBg:!1,contentCss:"",center:!1,width:!1,height:!1,content:"",scrollClose:!1,callback:!1,button:!1},b),f=[],g=0,h=window,i=document,j=!a.browser.msie||a.browser.version>6,k=e.width?"width:"+e.width+";":"",l=e.height?"height:"+e.height+";":"",m=j?"fixed":"absolute";if(d.close(),f[g++]='<div id="xiuPopBox" class="xiuPop default '+e.skin+'" style="position:'+m+"; z-index:9999px; display:none;"+k+l+" left:"+e.pageX+"px; top:"+e.pageY+'px">',e.title&&(f[g++]='<h1><a href="#" title="关闭" id="closeXiuPop">关闭</a>'+e.title+"</h1>"),f[g++]='<div class="content '+e.contentCss+'" id="xiuPopContent">'+e.content+"</div>",e.button&&(f[g++]='<div class="buttonZone" id="xiuPopBoxBtn">',f[g++]="</div>"),f[g++]="</div>",e.hasBg){var n=i.documentElement.scrollHeight;f[g++]='<div class="xiuPopBG" style="position:'+m+'" id="xiuPopBoxBG" style="height:'+n+'px"></div>'}if(f=f.join(""),a("body").append(f),"object"==typeof e.content&&(e.content.parent().append('<span id="xiuPopCopy"></span>'),a("#xiuPopContent").empty().append(e.content),a("#xiuPopBox").data("xiuPopCon",e.content)),a("#closeXiuPop").click(function(){return d.close(),!1}),a.each(e.button,function(b,c){a("<button>"+b+"</button>").unbind("click").bind("click",function(a){c(this)}).appendTo(i.getElementById("xiuPopBoxBtn"))}),e.callback&&(callback=e.callback||function(){},callback()),e.center){var o=a("#xiuPopBox"),p=o.width(),q=o.height();c(),a(h).bind("resize.popBox",function(){o.hide(),c(),o.show()}),e.scrollClose&&a(h).bind("scroll.popBox",function(){Math.abs(a("body").data("sTop")-a(h).scrollTop())>100&&a.closepop()})}a("body").data("showXiuPop",setTimeout(function(){a("#xiuPopBox").show(),0!=e.time&&a("#xiuPopBox").data("remove",setTimeout(function(){d.close()},1e3*e.time))},100)),a(i).unbind("keydown").bind("keydown",function(b){if(27==b.keyCode)return a.closepop(),!1})}}(jQuery),function(a){jQuery.fn.XTip=function(b){var c=this,d=a.extend({width:250},b),e=document.documentElement,f=self.innerWidth||e&&e.clientWidth||document.body.clientWidth,g=d.width;c.hover(function(){var b=this.getAttribute("tit")||"&nbsp;",c=this.getAttribute("con"),d=f-getAbsoluteLeft(this),e=getAbsoluteTop(this)-3;if(d>1*g+75){a("body").append("<div id='XT' class='shadow_XTR' style='width:"+1*g+"px'><div id='XT_arrow_left'></div><div id='XT_close_left'>"+b+"</div><div id='XT_copy'><div class='XT_loader'><div></div></div>");var h=this.offsetWidth+11,i=getAbsoluteLeft(this)+h}else{a("body").append("<div id='XT' class='shadow_XTL' style='width:"+1*g+"px'><div id='XT_arrow_right' style='left:"+(1*g+1)+"px'></div><div id='XT_close_right'>"+b+"</div><div id='XT_copy'><div class='XT_loader'><div></div></div>");var i=getAbsoluteLeft(this)-(1*g+15)}a("#XT").css({left:i+"px",top:e+"px"}).show(),document.getElementById(c)?a("#XT_copy").html(a("#"+c).html()):a("#XT_copy").html(c)},function(){a("#XT").remove()})}}(jQuery);